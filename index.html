<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Java avancé</title>
    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/solarized.css" id="theme">
    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
            crossorigin="anonymous"></script>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section>
            <h1>Java avancé</h1>
            <h3>RIL - CESi</h3>
        </section>
        <section data-auto-animate>
            <h3>Programme</h3>
            <hr>
            <p>
                <img width="25%" src="https://upload.wikimedia.org/wikipedia/uk/7/70/Spring_Framework.png">
            </p>
            <div class="row">
                <div class="col">
                    <h5 class="fragment fade-up fade-in-then-semi-out">Présentation</h5>
                    <h5 class="fragment fade-up fade-in-then-semi-out">Gradle</h5>
                    <h5 class="fragment fade-up fade-in-then-semi-out">JPA</h5>
                    <h5 class="fragment fade-up fade-in-then-semi-out">Spring ORM</h5>
                    <h5 class="fragment fade-up fade-in-then-semi-out">Spring MVC</h5>
                    <h5 class="fragment fade-up fade-in-then-semi-out">Spring BOOT</h5>
                </div>
            </div>
        </section>
        <section>
            <section>
                <h3>Présentation</h3>
            </section>
            <section>
                <h4>un framework ? Pourquoi faire ?</h4>
                <ul>
                    <li class="fragment">Uniformiser le travail des développeurs</li>
                    <li class="fragment">Réduire le temps de développement</li>
                    <li class="fragment">Réduire les coûts de développement</li>
                    <li class="fragment">Rendre la solution prérenne</li>
                    <li class="fragment">Avoir l'appui d'une énorme communautée</li>
                </ul>
            </section>
            <section data-background-image="https://media.giphy.com/media/M8zfZXu3z7OnDY9grz/source.gif">
                <h4>un framework ? Pourquoi faire ?</h4>
                <ul>
                    <li>Uniformiser le travail des développeurs</li>
                    <li>Réduire le temps de développement</li>
                    <li>Réduire les coûts de développement</li>
                    <li>Rendre la solution prérenne</li>
                    <li>Avoir l'appui d'une énorme communautée</li>
                </ul>
            </section>
            <section>
                <h4>Architecture</h4>
                <h5>Une application va être découpée en 3 couches</h5>
                <ul>
                    <li>La couche présentation</li>
                    <li>La couche métier</li>
                    <li>La couche données</li>
                </ul>
            </section>
            <section>
                <h4>Framework Web</h4>
                <p>Un framework web respecte le design pattern MVC (Model View Controler)</p>
            </section>
            <section>
                <h4>Quelques frameworks web</h4>
                <ul>
                    <li>JSF</li>
                    <li>Struts</li>
                    <li>Spring MVC</li>
                </ul>
            </section>
            <section>
                <h4>Quelques framework de persistance des données</h4>
                <div class="row">
                    <div class="col">
                        <ul>
                            <li><img src="https://hibernate.org/images/hibernate-logo.svg" width="33%"></li>
                            <li><img src="https://www.eclipse.org/eclipselink/images/logo.png" width="33%"></li>
                            <li><img
                                    src="https://dimitr.im/static/8f8361cc803cd49880a20b0075d60813/c6a2b/spring-data.png"
                                    width="15%"></li>
                        </ul>
                    </div>
                </div>
            </section>
            <section data-auto-animate>
                <h4>Spring framework</h4>
                <p>Spring est le leader sur le marché des framework Java</p>
                <div data-id="logoSpring">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Spring_Framework_Logo_2018.svg/langfr-1920px-Spring_Framework_Logo_2018.svg.png">
                </div>
            </section>
            <section data-auto-animate>
                <div class="row">
                    <div class="col">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Spring_Framework_Logo_2018.svg/langfr-1920px-Spring_Framework_Logo_2018.svg.png"
                             width="15%">
                    </div>
                </div>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <ul>
                            <li>Créé en 2004 par Rod Johnson</li>
                            <li>Prend en charge la création et la mise en relation d'objets grâce à des fichiers de
                                configuration
                            </li>
                        </ul>
                    </div>
                    <div class="col">
                        <ul>
                            <li>Permet la création :</li>
                            <ul>
                                <li>D'applications web</li>
                                <li>De micro services</li>
                                <li>De batchs</li>
                                <li>D'applications console</li>
                            </ul>
                        </ul>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <p>Spring est sécurisé, rapide et accroit la productivité</p>
                </div>
            </section>
        </section>
        <section>
            <section><h3>Gradle</h3></section>
            <section>
                <h5>Gradle est un moteur de production qui permet l'automatisation des actions nécessaire à la mise en
                    place et l'exploitation d'une application à partir des fichiers sources.</h5>
                <ul>
                    <li>Apache Ant</li>
                    <li>Maven</li>
                    <li>Gradle</li>
                </ul>
            </section>
            <section>
                <img src="https://upload.wikimedia.org/wikipedia/fr/e/ed/Gradle_Logo.png">
                <hr>
                <h5>Gradle est capable de récupérer des dépendances à partir :</h5>
                <ul>
                    <li>des dépôts Maven</li>
                    <li>Ivy</li>
                    <li>SubVersion</li>
                    <li>N'importe quel système de fichiers</li>
                </ul>
            </section>
            <section>
                <h4>Gradle est basé sur Groovy</h4>
                <img src="https://blog.knoldus.com/wp-content/uploads/2018/01/1200px-Groovy-logo.svg_.png">
                <h5>Il gère la compilation , les tests, la génération des jar et/ou war et le déploiement</h5>
            </section>
            <section>
                <div class="row">
                    <div class="col">
                        <img src="img/gradleV.PNG">
                    </div>
                    <div class="col">
                        <img src="https://gradle.org/images/homepage/gradle-org-hero.png">
                        <p>Gradle version 6.7.1</p>
                    </div>
                </div>
            </section>
            <section>
                <h4>Génération d'un nouveau projet Gradle</h4>
                <pre><code>gradle init</code></pre>
                <ul>
                    <li>build.gradle</li>
                    <li>settings.gradle</li>
                    <li>.gradle</li>
                    <li>gradle</li>
                    <li>gradlew</li>
                    <li>gradlew.bat</li>
                </ul>
            </section>
            <section>
                <h4>plugins</h4>
                <h5>https://plugins.gradle.org/</h5>
                <pre class="fragment"><code>plugins {
    id 'application'
}
repositories {
    jcenter()
}
dependencies {
    testImplementation 'junit:junit:4.13'
    implementation 'com.google.guava:guava:29.0-jre'
}
application {
    mainClass = 'fr.cesi.App'
}</code></pre>
            </section>
            <section>
                <h5>L'ajout d'un plugin ajoute des tâches supplémentaires à Gradle</h5>
                <ul>
                    <li>assemble</li>
                    <li>build</li>
                    <li>clean</li>
                    <li>jar</li>
                    <li>...</li>
                </ul>
            </section>
            <section>
                <div class="row">
                    <h4>IntelliJ</h4>
                </div>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/IntelliJ_IDEA_Logo.svg/1200px-IntelliJ_IDEA_Logo.svg.png">
                    </div>
                    <div class="col">
                        <h5>Bien entendu, Gradle est intégré à IntelliJ</h5>
                        <img src="img/intelliJgradle.PNG">
                    </div>
                </div>
            </section>
            <section>
                <div class="row">
                    <h4>TP</h4>
                </div>
                <hr>
                <div class="row">
                    <div class="col">
                        <img src="https://media.giphy.com/media/3oriO7A7bt1wsEP4cw/giphy.gif">
                    </div>
                    <div class="col">
                        <h6>- Créer une application JavaEE</h6>
                        <h6>- Ajouter le plugin gretty</h6>
                        <h6>- Créer un dossier webapp dans le dossier "src/main/" et ajoutez y un fichier
                            index.html</h6>
                        <h6>- En utilisant Bootstrap, afficher la liste des 5 meilleurs films de tout les temps
                            (gladiator doit en faire parti ^^)</h6>
                        <h6>- Utiliser la commande gradle adéquate pour lancer un serveur Tomcat contenant l'application
                            créé</h6>
                    </div>
                </div>
                <hr>
            </section>
        </section>
        <section>
            <section><h3>JPA (Java Persistence API)</h3></section>
            <section>
                <h4>Pourquoi JPA ?</h4>
                <ul>
                    <li>Java est orienté objet</li>
                    <li>Les bases de données sont relationnelles</li>
                </ul>
                <p>Un ORM permet de faire correspondre un objet Java à une base de donnée relationnelle</p>
            </section>
            <section>
                <p>Les annotations vont faire correspondre : <br>
                    - une classe avec une table <br>
                    - un attribut avec une colonne</p>
                <img src="https://i.stack.imgur.com/CqODs.png">
            </section>
            <section data-auto-animate>
                <pre data-id="code"><code data-trim data-line-numbers>package fr.cesi;
public class Avengers {
    private int id;
    private String nom;
    private String prenom;
    private int taille;
}
                </code></pre>
            </section>
            <section data-auto-animate>
                <pre data-id="code"><code data-trim data-line-numbers>package fr.cesi;
import javax.persistence.*;
@Entity
@Table(name = "laTableDesAvengers")
public class Avengers {
    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE)
    private int id;
    @Column(name = "leNomDeLaColonne")
    private String nom;
    private String prenom;
    @Transient
    private int taille;
}
                </code></pre>
            </section>
            <section>
                <div class="row"><p> ressources/META-INF/persistence.xml</p>
                </div>
                <div class="row justify-content-center align-items-center">
                    <div class="col-9">
                <pre><code data-trim data-line-numbers><persistence xmlns="http://xmlns.jcp.org/xml/ns/persistence"
                                                                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                                                                    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence
             http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"
                                                                    version="2.1">
    <persistence-unit name="cesiBDD" transaction-type="RESOURCE_LOCAL">
        <class>fr.cesi.MonPojo</class>
        <properties>
            <property name="javax.persistence.jdbc.driver" value="org.postgresql.Driver"/> <!-- DB Driver -->
            <property name="javax.persistence.jdbc.url" value="jdbc:postgresql://localhost/cesi"/> <!-- BD Mane -->
            <property name="javax.persistence.jdbc.user" value="postgres"/> <!-- DB User -->
            <property name="javax.persistence.jdbc.password" value="azerty,123"/> <!-- DB Password -->
            <property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQL82Dialect"/> <!-- DB Dialect -->
            <property name="hibernate.hbm2ddl.auto" value="update"/> <!-- create / create-drop / update -->
            <property name="hibernate.show_sql" value="true"/> <!-- Show SQL in console -->
            <property name="hibernate.format_sql" value="true"/> <!-- Show SQL formatted -->
        </properties>
    </persistence-unit>
                </persistence></code></pre>
                    </div>
                    <div class="col-3 fragment">
                        <img src="https://media.giphy.com/media/xTiIzoyw4Yh3mRM5DG/giphy.gif" alt="">
                    </div>
                </div>
            </section>
            <section>
                <h4>Java Persistence Query Language</h4>
                <p>JPQL permet de faire des requêtes sur une base de données en utilisant les objets Java.</p>
            </section>
            <section>
                <p>Les requêtes nommées définies à l'interieur d'une classe Java</p>
                <pre><code data-trim data-line-numbers>@NamedQueries({
    @NamedQuery(name="touslespokemons", query="SELECT nom FROM pokemon"),
    @NamedQuery(name="unpokemon", query="SELECT nom FROM pokemon where nom = :nom")
})
                </code></pre>
                <p>Utilisées ensuite dans l'application</p>
                <pre><code data-trim data-line-numbers>TypedQuery<Pokemon> requete = em.createNamedQuery("touslespokemons", Pokemon.class);
System.out.println(requete.getResultList());</code></pre>
            </section>
            <section>
                <p>Les requêtes dynamiques</p>
                <pre><code data-trim data-line-numbers>Query requete = em.createQuery("Select nom FROM Pokemon WHERE nom ='Pikachu'");
Pokemon p = requete.getSingleResult();
                </code></pre>
                <pre><code data-trim data-line-numbers>Query requete = em.createQuery("Select nom FROM Pokemon WHERE nom =:nom");
requete.setParameter("nom", "Pikachu");
Pokemon p = requete.getSingleResult();
                </code></pre>
            </section>
            <section>
                <div class="row">
                    <h4>TP</h4>
                </div>
                <hr>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <img src="https://media.giphy.com/media/toXKzaJP3WIgM/giphy.gif">
                    </div>
                    <div class="col">
                        <h6>- Créer une application Java avec Gradle</h6>
                        <h6>- Ajouter une dépendance à hibernate et à pgSQL</h6>
                        <h6>- Proposer un menu permettant l'ajout, le tri, la suppression et la recherche de Pokemon en
                            base de données</h6>
                        <h6>- Respecter l'architecture suivante : <img src="img/tp02.PNG"></h6>
                    </div>
                </div>
                <hr>
            </section>
            <section>
                <h4>Relations et cardinalité</h4>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <ul>
                            <li>One to one</li>
                            <li>One to many</li>
                            <li>Many to one</li>
                            <li>Many to many</li>
                        </ul>
                    </div>
                    <div class="col"><img src="https://dev.mysql.com/doc/sakila/en/images/sakila-schema.png" alt="">
                    </div>
                </div>
            </section>
            <section>
                <div class="row">
                    <h4>TP</h4>
                </div>
                <hr>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <img src="https://media.giphy.com/media/rAm0u2k17rM3e/giphy.gif">
                    </div>
                    <div class="col">
                        <h6>En reprenant l'application précédente</h6>
                        <h6>- Ajouter un bean Dresseur</h6>
                        <h6>- Créer une liaison bidirectionelle. Un dresseur peut avoir plusieurs Pokemons. Un Pokemon
                            n'a qu'un et un seul dresseur</h6>
                    </div>
                </div>
                <hr>
            </section>
        </section>
        <section>
            <section><h3>Spring ORM</h3></section>
            <section>
                <p>Spring ORM est défini par des fichiers de configuration XML</p>
                <ul>
                    <li>datasource.properties</li>
                    <li>ApplicationContext.xml</li>
                </ul>
            </section>
            <section>
                <h4>datasource.properties va contenir tout les informations de connexion de la base de données</h4>
                <pre><code data-trim data-line-numbers>driver=org.postgresql.Driver
url=jdbc:postgresql://localhost/spring_orm
user=postgres
pass=azerty</code></pre>
                <img src="https://media.giphy.com/media/TL5XQpSpASo4U/giphy.gif">
            </section>
            <section>
                <p>ApplicationContext.xml va, lui, définir tous les beans nécessaires à l'application</p>
                <ul>
                    <li>La source de donnée</li>
                    <li>L'usine à DAO</li>
                    <li>Le manager</li>
                </ul>
            </section>
            <section>
                <h4>datasource</h4>
                <pre><code data-trim data-line-numbers="|1|2|3-7"><context:property-placeholder
                        location="classpath:/database.properties"></context:property-placeholder>
<bean id="dataSource" class="org.apache.commons.dbcp2.BasicDataSource">
   <property name="driverClassName" value="${driver}"></property>
   <property name="url" value="${url}"></property>
   <property name="username" value="${user}"></property>
   <property name="password" value="${pass}"></property>
   <property name="initialSize" value="5"></property>
</bean>
                </code></pre>
            </section>
            <section>
                <h4>L'usine</h4>
                <pre><code data-trim data-line-numbers><bean id="emf"
                                                             class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
<property name="packagesToScan">
   <list>
      <value>fr.cesi.bean</value>
   </list>
 </property>
 <property name="dataSource" ref="dataSource"></property>
 <property name="jpaVendorAdapter">
    <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
      <property name="showSql" value="true"></property>
      <property name="database" value="POSTGRESQL"></property>
    </bean>
 </property>
 <property name="jpaProperties">
   <props>
      <prop key="hibernate.hbm2ddl.auto">create</prop>
   </props>
 </property>
</bean>
                </code></pre>
            </section>
            <section>
                <h4>Le manageur</h4>
                <pre><code data-trim data-line-numbers><bean id="transactionManager"
                                                             class="org.springframework.orm.jpa.JpaTransactionManager">
   <property name="entityManagerFactory" ref="emf"></property>
</bean>
<tx:annotation-driven transaction-manager="transactionManager"></tx:annotation-driven></code></pre>
            </section>
            <section>
                <h4>DAO</h4>
                <p>Il est alors tout a fait possible d'injecter directement une instance de l'EntityManager dans ma
                    classe Java</p>
                <pre><code data-trim data-line-numbers>@Repository
   public class MonDAO {
      @PersistenceContext
      EntityManager em;
}                </code></pre>
            </section>
            <section>
                <p>Et l'utiliser dans les méthodes</p>
                <pre><code data-trim data-line-numbers>@Transactional
public void ajouter(Pokemon p) {
   em.persist(p);
}</code></pre>
                <p class="fragment">Lorsqu'une méthode réalise un transaction SQL alors l'annotation @Transactional est
                    obligatoire</p>
            </section>
            <section>
                <div class="row">
                    <h4>TP</h4>
                </div>
                <hr>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <img src="https://media.giphy.com/media/hOzfvZynn9AK4/giphy.gif">
                    </div>
                    <div class="col">
                        <h5>En utilisant l'application développé précédemment :</h5>
                        <h6>- Utiliser Spring ORM pour réaliser l'ensemble des requêtes SQL</h6>
                        <h6>- Proposer une interface web en ajoutant le plugins Gretty et War</h6>
                    </div>
                </div>
                <hr>
            </section>
            <section>
                <h4>Mieux encore, Spring Data permet <b class="fragment highlight-red">de ne plus écrire</b> les méthodes du CRUD et les méthodes les
                    plus utilisées d'une application classique</h4>
                <pre class="fragment"><code>public class MonDAO extends JpaRepository&#x3008;Pokemon, Integer&#x3009;{
}</code></pre>
            </section>
        </section>
        <section>
            <section><h3>Spring MVC</h3></section>
            <section>
                <p>MVC (Model View Controler) est un patron de conception très utilisé en développement d'interface
                    graphique</p>
                <p>
                <div class="row justify-content-center align-items-center">
                    <div class="col">
                        <ul>
                            <h4>Le modèle contient les données</h4>
                            <h4>La vue est la partie visible de l'iceberg</h4>
                            <h4>Le controleur est la logique de l'application </h4>
                        </ul>
                    </div>
                    <div class="col">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/MVC-Process.svg/1200px-MVC-Process.svg.png"
                             alt="">
                    </div>
                </div>
            </section>
            <section>
                Spring utilise un controleur frontal qui va "dispatcher", aux différents autres controleurs, les
                demandes utilisateurs.<br>
                <div class="row justify-content-center align-items-center">
                    <div class="col-3">
                        <img src="https://media.giphy.com/media/1oEttHTW7Dh6WFabZd/giphy.gif" alt=""></div>
                </div>
                Il est déclaré dans le fichier web.xml
            </section>
            <section>
                <pre><code data-trim data-line-numbers><servlet>
   <servlet-name>dispatcher</servlet-name>
   <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
   <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
   <servlet-name>dispatcher</servlet-name>
   <url-pattern>/app/*</url-pattern>
</servlet-mapping></code></pre>
            </section>
            <section>
                <pre><code data-trim data-line-numbers><context:annotation-config></context:annotation-config>
<context:component-scan base-package="fr.cesi.controller"></context:component-scan>
<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"></property>
    <property name="prefix" value="/WEB-INF/jsp/"></property>
    <property name="suffix" value=".jsp"></property>
</bean></code></pre>
            </section>
            <section>
                <div class="row">
                    <div class="col">
                        Un controleur est une classe Java surmontée de l'annotation @Controller
                    </div>
                    <div class="col">
                        <pre><code data-trim data-line-numbers>@Controller
public class MonControleur {
   public String home() {
      return "home";
   }
}</code></pre>
                    </div>
                </div>
            </section>
            <section>
                <div class="row">
                    <div class="col">
                        Sur chaque méthode est ajoutée une annotation pour spécifier quel type de requête HTTP doit
                        être
                        utilisée et quelle url
                    </div>
                </div>
                <div class="row" data-id="code">
                    <div class="col">
                        <pre><code data-trim data-line-numbers>@Controller
public class MonControleur {
   @RequestMapping(method=RequestMethod.GET, path="/home")
   public String home() {
      return "home";
   }
}</code></pre>
                    </div>
                </div>
            </section>
            <section>
                Si la méthode retourne "home" alors le controleur utilisera le fichier home.jsp situé dans le
                dossier
                webapp/WEB-INF/jsp
                <div class="row" data-id="code">
                    <div class="col">
                        <pre><code data-trim data-line-numbers>@Controller
public class MonControleur {
   @RequestMapping(method=RequestMethod.GET, path="/home")
   public String home() {
      return "home";
   }
}</code></pre>
                    </div>
                </div>
            </section>
        </section>
    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/zoom/zoom.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/search/search.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>

    // Also available as an ES module, see:
    // https://revealjs.com/initialization/
    Reveal.initialize({
        controls: true,
        progress: true,
        center: true,
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight]
    });

</script>
</body>
</html>
